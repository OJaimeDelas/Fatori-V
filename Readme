# FATORI-V — Top-Level Controller

FATORI-V is a two-layer framework for fault-tolerant RISC-V experiments:

- **Hardware layer** (in `architecture/` + `hardware/`): Ibex-based SoC with
  fault-tolerance mechanisms (FTMs), monitoring and fault-injection hooks.
- **Software layer** (in `scripts/` + `fi/`): Python tools that read a YAML
  description of a *run*, generate `.svh` / `.tcl` files, build the design,
  run benchmarks, optionally inject faults, and collect results.

Each YAML file under `runs/` describes **one run**. The top-level script
`fatori-v.py` executes a run in four phases:

1. **Generation** – `scripts/ftm`, `scripts/features`, `scripts/pblocks` create
   the FATORI-V headers for this run and store copies under `gen/<run_id>/`.
2. **Build** – `scripts/build` stages generated headers into the RTL tree,
   overlays `hardware/` over the reference `architecture/` (if present), and
   calls the underlying build system (usually via `make`).
3. **Execution** – `scripts/exec` runs one or more *sessions* (benchmarks),
   optionally calling the FI console in `fi/` to inject faults during each
   session.
4. **Results** – `scripts/results` collects logs and artifacts into
   `results/<run_id>/`, optionally including plots, Vivado reports and
   metric summaries.

> **Note** — The FI console (`fi/`) is designed to be usable on its own, but
> FATORI-V orchestrates it when FI is enabled in the run YAML.

## Folder map (top-level)

- **runs/** — Input YAMLs; one file per run. See `runs/Readme` and
  `runs/example.yaml`.
- **gen/** — Per-run copies of *generated* headers and TCL (`*.svh`, `*.tcl`).
  See `gen/Readme`.
- **build/** — User-provided inputs and overrides for the build. See
  `build/Readme`.
- **results/** — Per-run/per-session outputs (logs, metrics, plots, reports).
  See `results/Readme`.
- **scripts/** — control and generation scripts (non-FI). Each subfolder
  has its own `Readme` explaining its phase.
- **fi/** — Fault-injection console (ACME/SEM, area/time profiles, FI logging).
  See `fi/Readme`.
- **hardware/** — RTL (`.sv`/`.v`) that overrides or extends the reference
  design from `architecture/`. See `hardware/Readme`.
- **architecture/** *(optional)* — Git submodule pointing to the baseline SoC
  design. This folder is not part of this ZIP but is expected in a full clone.
- **fatori_settings.py** — Top-level defaults (paths, global flags) used when
  YAML fields are missing or invalid.
- **fatori-v.py** — Main entry point: reads a run YAML, then calls the phase
  scripts under `scripts/` in sequence.

## Extending the system

- To add **new FTMs or monitoring headers**, see `scripts/ftm/Readme`.
- To add **new user benchmarks**, see `scripts/exec/benchmarks/Readme`.
- To add **new metrics**, see `scripts/exec/metrics/Readme`.
- To add **new YAML validity checks**, see
  `scripts/common/yaml_io/yaml_checks.py`.
