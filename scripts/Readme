# FATORI-V — `scripts/`

Python control layer for a single run.

This folder contains the high-level scripts that `fatori-v.py` calls to
generate headers, build the hardware, execute benchmarks (with optional fault
injection) and gather results. The idea is that each area has:

- a small **settings** file with defaults for that area,
- one **main** script that reads the YAML and calls a few helpers,
- all heavier logic in subfolders (helpers, generators, etc.).

The FI console itself lives separately under `fi/` and is only invoked through
a small bridge in `scripts/exec/fi_bridge/`.

## Layout

- `build/`    — build phase (staging generated files and calling `make`).
- `common/`   — shared helpers (YAML loading, logging, `.svh` / `.tcl` writers).
- `exec/`     — run-time execution: benchmarks, metrics and FI bridge.
- `features/` — generation of `fatori_features.svh` from the YAML.
- `ftm/`      — generation of fault-tolerance mechanism headers (`fatori_ftm.svh`,
                `fatori_reg_mon.svh`, `fatori_logic_mon.svh`, `fatori_selftest.svh`).
- `pblocks/`  — generation of `fatori_pblocks.svh` and `fatori_pblocks.tcl`.
- `results/`  — scripts that collect and mirror run artefacts under `results/`.
- `run/`      — reserved for future helpers that operate on multiple runs.

Each of these subfolders has its own `Readme`, a `<area>_settings.py` file and
one "big" script (`fatori_<area>.py`) that tells the story for that phase.

## Relationship with the YAML

The scripts in this tree do not define the user interface; they *consume* the
run YAML from `runs/` and apply defaults from the various `*_settings.py`
files. The top-level YAML has three main blocks:

- `run`       — identification and hardware selection.
- `general`   — top-level enables for features, FTMs, benchmarks, results, FI.
- `specifics` — detailed tuning of anything enabled in `general`.

Each area in `scripts/` is responsible for interpreting the part of the YAML
that is relevant to it:

- FTM scripts read the FTM-related keys from `general` and `specifics.ftm`.
- Features scripts read `general.features`.
- Build scripts use `run.hardware` and the FTM/feature choices to invoke the
  correct underlying build targets.
- Exec scripts read `specifics.benchmarks` and `specifics.fault_injection`.
- Results scripts read `general.results` and/or `specifics.results` to decide
  what to save.

For details on how to extend specific subsystems, see the Readmes in the
corresponding subfolders. For example:

- To add new benchmarks, see `exec/benchmarks/Readme`.
- To add new metrics, see `exec/metrics/Readme`.
